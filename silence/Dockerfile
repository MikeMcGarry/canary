FROM python:latest

WORKDIR /tmp/silence

COPY ./requirements.txt .

RUN pip install -r requirements.txt

ENV TWILIO_ACCOUNT_ID $TWILIO_ACCOUNT_ID
ENV TWILIO_AUTH_TOKEN $TWILIO_AUTH_TOKEN
ENV AWS_SERVER_PUBLIC_KEY_LOGS $AWS_SERVER_PUBLIC_KEY_LOGS
ENV AWS_SERVER_SECRET_KEY_LOGS $AWS_SERVER_SECRET_KEY_LOGS
ENV AWS_SERVER_SECRET_KEY_ATHENA $AWS_SERVER_SECRET_KEY_ATHENA
ENV AWS_SERVER_SECRET_KEY_ATHENA $AWS_SERVER_SECRET_KEY_ATHENA
ENV SUBSCRIBERS_QUERY_RESULTS_S3_BUCKET_NAME $SUBSCRIBERS_QUERY_RESULTS_S3_BUCKET_NAME
ENV POLLUTION_QUERY_RESULTS_S3_BUCKET_NAME $SUBSCRIBERS_QUERY_RESULTS_S3_BUCKET_NAME
ENV POLLUTION_DATABASE_NAME $SUBSCRIBERS_QUERY_RESULTS_S3_BUCKET_NAME
ENV NOTIFICATION_LOGS_S3_BUCKET_NAME $SUBSCRIBERS_QUERY_RESULTS_S3_BUCKET_NAME

COPY . .

CMD ["python", "-u", "silence.py"]
